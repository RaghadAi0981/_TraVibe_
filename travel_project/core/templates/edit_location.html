{% extends "base.html" %}
{% block title %}Edit Location ¬∑ {{ place.name }} ¬∑ TraVibe{% endblock %}
<a href="{% url 'add_place' city.id %}"
   class="mb-4 inline-flex items-center rounded-xl bg-slate-900 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-slate-800">
  ‚ûï Add Place (Map Search)
</a>

{% block content %}
<div class="mb-6">
  <div class="text-sm text-slate-500">
    <a class="hover:underline" href="{% url 'place_detail' place.id %}">{{ place.name }}</a>
    <span class="mx-2">/</span>
    <span>Edit location</span>
  </div>

  <h1 class="mt-3 text-3xl font-semibold tracking-tight">üìç Edit location</h1>
  <p class="mt-1 text-slate-600">Search and choose the correct location.</p>
</div>

<form method="get" class="mb-4 flex flex-wrap gap-2">
  <input type="text" name="q" value="{{ q }}"
    placeholder="Search again (name + city helps)"
    class="w-full sm:w-[420px] rounded-xl border bg-white px-4 py-2 text-sm shadow-sm focus:outline-none focus:ring" />

  <button class="rounded-xl bg-slate-900 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-slate-800">
    Search
  </button>

  <a href="{% url 'place_detail' place.id %}"
     class="rounded-xl border bg-white px-4 py-2 text-sm shadow-sm hover:bg-slate-50">
    Cancel
  </a>
</form>

{% if error %}
<div class="mb-4 rounded-2xl border border-rose-200 bg-rose-50 p-4 text-sm text-rose-700">
  Error: {{ error }}
</div>
{% endif %}

{% if q and results %}
<div class="grid gap-3">
  {% for r in results %}
  <div class="rounded-2xl border bg-white p-4 shadow-sm">
    <div class="flex flex-wrap items-start justify-between gap-3">
      <div>
        <div class="text-base font-semibold">{{ r.display_name|truncatechars:90 }}</div>
        <div class="mt-1 text-xs text-slate-500">Lat: {{ r.lat }} ¬∑ Lon: {{ r.lon }}</div>
      </div>

      <form method="post" class="shrink-0">
        {% csrf_token %}
        <input type="hidden" name="lat" value="{{ r.lat }}">
        <input type="hidden" name="lon" value="{{ r.lon }}">
        <input type="hidden" name="display_name" value="{{ r.display_name }}">
        <button class="rounded-xl bg-emerald-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-emerald-700">
          Use this
        </button>
      </form>
    </div>
  </div>
  {% endfor %}
</div>
{% elif q %}
<div class="rounded-2xl border bg-white p-6 text-slate-600">
  No results found. Try different keywords.
</div>
{% endif %}
{% endblock %}
